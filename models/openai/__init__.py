"""
Adapted from openai's repos:
 - https://github.com/openai/improved-diffusion
 - https://github.com/openai/guided-diffusion
"""